{"version":3,"sources":["src/PNotifyHistory.html"],"names":[],"mappings":"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","sourcesContent":["<script>\n  import PNotify from './PNotify.html';\n\n  export default {\n    setup (Component) {\n      Component.key = 'History';\n\n      Component.defaults = {\n        // Place the notice in the history.\n        history: true,\n        // Maximum number of notices to have open in its stack.\n        maxInStack: Infinity\n      };\n\n      Component.init = (notice) => {\n        return new Component({target: document.body});\n      };\n\n      Component.showLast = (stack) => {\n        if (stack === undefined) {\n          stack = PNotify.defaultStack;\n        }\n        if (stack === false) {\n          return;\n        }\n        const top = (stack.push === 'top');\n\n        // Look up the last history notice, and display it.\n        let i = (top ? 0 : PNotify.notices.length - 1);\n\n        let notice;\n        do {\n          notice = PNotify.notices[i];\n\n          if (!notice) {\n            return;\n          }\n\n          i += (top ? 1 : -1);\n        } while (\n          notice.get().stack !== stack ||\n          !notice.get()._modules.History.get().history ||\n          notice.get()._state === 'opening' ||\n          notice.get()._state === 'open'\n        );\n\n        notice.open();\n      };\n\n      Component.showAll = (stack) => {\n        if (stack === undefined) {\n          stack = PNotify.defaultStack;\n        }\n        if (stack === false) {\n          return;\n        }\n\n        // Display all notices. (Disregarding non-history notices.)\n        for (let i = 0; i < PNotify.notices.length; i++) {\n          const notice = PNotify.notices[i];\n          if (\n            (\n              stack === true ||\n              notice.get().stack === stack\n            ) &&\n            notice.get()._modules.History.get().history\n          ) {\n            notice.open();\n          }\n        }\n      };\n\n      // Register the module with PNotify.\n      PNotify.modules.History = Component;\n    },\n\n    data () {\n      return Object.assign({\n        '_notice': null, // The PNotify notice.\n        '_options': {} // The options for the notice.\n      }, PNotify.modules.History.defaults);\n    },\n\n    methods: {\n      initModule (options) {\n        this.set(options);\n\n        if (this.get().history) {\n          // Don't destroy notices that are in history.\n          const {_notice} = this.get();\n          if (_notice.get().destroy) {\n            _notice.set({'destroy': false});\n          }\n        }\n      },\n\n      beforeOpen () {\n        const {maxInStack, _options} = this.get();\n        if (maxInStack === Infinity) {\n          return;\n        }\n\n        const stack = _options.stack;\n        if (stack === false) {\n          return;\n        }\n\n        // Remove oldest notifications leaving only maxInStack from the stack.\n        if (PNotify.notices && (PNotify.notices.length > maxInStack)) {\n          // Oldest are normally in front of array, or if stack.push=='top' then\n          // they are at the end of the array!\n          const top = stack.push === 'top';\n          const forRemoval = [];\n          let currentOpen = 0;\n\n          for (let i = (top ? 0 : PNotify.notices.length - 1); (top ? i < PNotify.notices.length : i >= 0); (top ? i++ : i--)) {\n            if (\n              ['opening', 'open'].indexOf(PNotify.notices[i].get()._state) !== -1 &&\n              PNotify.notices[i].get().stack === stack\n            ) {\n              if (currentOpen >= maxInStack) {\n                forRemoval.push(PNotify.notices[i]);\n              } else {\n                currentOpen++;\n              }\n            }\n          }\n\n          for (let i = 0; i < forRemoval.length; i++) {\n            forRemoval[i].close(false);\n          }\n        }\n      }\n    }\n  };\n</script>\n"]}